Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
src/main.py:81: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working
  if isinstance(v, collections.Mapping):
wandb: [wandb.login()] Loaded credentials for https://api.wandb.ai from /home/pparsons/.netrc.
wandb: Currently logged in as: peterparsons02 (peterparsons02-eth-z-rich) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run h3ryr725
wandb: Tracking run with wandb version 0.24.1
wandb: Run data is saved locally in /usr/itetnas04/data-scratch-01/pparsons/data/MyExpoComm/wandb/run-20260206_021231-h3ryr725
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run my_run-HybridComm-20260206_021230
wandb: ‚≠êÔ∏è View project at https://wandb.ai/peterparsons02-eth-z-rich/my_experiment
wandb: üöÄ View run at https://wandb.ai/peterparsons02-eth-z-rich/my_experiment/runs/h3ryr725
2026-02-06 02:12:33,398 - my_experiment - HybridComm - my_run - INFO - Current directory: /usr/itetnas04/data-scratch-01/pparsons/data/MyExpoComm.
2026-02-06 02:12:33,399 - my_experiment - HybridComm - my_run - INFO - Experiment Parameters:
2026-02-06 02:12:33,400 - my_experiment - HybridComm - my_run - INFO - 

{   'action_selector': 'epsilon_greedy',
    'add_value_last_step': True,
    'agent': 'ExpoComm_static',
    'agent_output_type': 'q',
    'attention_dim': 32,
    'aux_coef': 0.1,
    'batch_size': 32,
    'batch_size_run': 1,
    'buffer_cpu_only': True,
    'buffer_size': 5000,
    'checkpoint_path': '',
    'double_q': True,
    'env': 'MAgent_Battle',
    'env_args': {   'global_reward': True,
                    'map_name': 'battle_view7',
                    'map_size': 25,
                    'max_cycles': 200,
                    'minimap_mode': False,
                    'pretrained_ckpt': None,
                    'seed': 42},
    'epsilon_anneal_time': 500000,
    'epsilon_finish': 0.05,
    'epsilon_start': 1.0,
    'evaluate': False,
    'evaluation_epsilon': 0.0,
    'exp_name': 'my_experiment',
    'gamma': 0.99,
    'global_reward': True,
    'grad_norm_clip': 10,
    'hidden_dim': 64,
    'hypergroup': None,
    'label': 'default_label',
    'learner': 'hybrid_comm_learner',
    'learner_log_interval': 10000,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 10000,
    'lr': 0.0005,
    'mac': 'ExpoComm_mac',
    'mixer': None,
    'name': 'HybridComm',
    'neg_num': 20,
    'obs_agent_id': True,
    'obs_individual_obs': False,
    'obs_last_action': True,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'render': False,
    'repeat_id': 1,
    'run_name': 'my_run',
    'runner': 'episode',
    'runner_log_interval': 10000,
    'save_model': True,
    'save_model_interval': 200000,
    'save_replay': False,
    'seed': 42,
    'standardise_returns': False,
    'standardise_rewards': True,
    't_max': 2000000,
    'target_update_interval_or_tau': 200,
    'temperature': 0.07,
    'test_greedy': True,
    'test_interval': 50000,
    'test_nepisode': 100,
    'topk_neighbors': 5,
    'use_cuda': True,
    'use_rnn': True,
    'use_tensorboard': True,
    'work_dir': 'work_dirs/my_experiment/HybridComm/my_run/20260206_021230'}

/scratch/slurm/spool/job1723639/slurm_script: line 71: 1345523 Killed                  python src/main.py --config=HybridComm --env-config=MAgent_Battle --t_max=2000000 --epsilon_anneal_time=500000 --save_model_interval=200000 --test_interval=50000 --log_interval=10000 --runner_log_interval=10000 --learner_log_interval=10000 --buffer_size=5000 --batch_size=32 --target_update_interval_or_tau=200 --test_nepisode=100
slurmstepd: error: Detected 1 oom_kill event in StepId=1723639.batch. Some of the step tasks have been OOM Killed.
